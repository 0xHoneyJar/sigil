{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://sigil.dev/schemas/philosophy.schema.json",
  "title": "Sigil Philosophy Schema",
  "description": "Schema for defining product philosophy, intent hierarchy, and conflict resolution rules.",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version",
      "default": "3.0.0"
    },
    "codename": {
      "type": "string",
      "description": "Philosophy codename or title"
    },
    "intent": {
      "$ref": "#/definitions/Intent"
    },
    "principles": {
      "type": "array",
      "description": "Ordered list of design principles",
      "items": {
        "$ref": "#/definitions/Principle"
      },
      "minItems": 1
    },
    "conflict_resolution": {
      "$ref": "#/definitions/ConflictResolution"
    },
    "decision_hierarchy": {
      "type": "array",
      "description": "Priority order for conflicts (first wins)",
      "items": {
        "type": "string"
      }
    }
  },
  "required": ["version", "intent", "principles", "conflict_resolution"],
  "definitions": {
    "Intent": {
      "type": "object",
      "description": "Product intent hierarchy",
      "properties": {
        "primary": {
          "type": "string",
          "description": "Primary product goal"
        },
        "secondary": {
          "type": "array",
          "description": "Secondary goals in priority order",
          "items": {
            "type": "string"
          }
        },
        "anti_goals": {
          "type": "array",
          "description": "What we explicitly do NOT want",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["primary"]
    },
    "Principle": {
      "type": "object",
      "description": "A design principle with rationale",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the principle"
        },
        "name": {
          "type": "string",
          "description": "Human-readable name"
        },
        "statement": {
          "type": "string",
          "description": "The principle statement"
        },
        "rationale": {
          "type": "string",
          "description": "Why this principle exists"
        },
        "examples": {
          "type": "array",
          "description": "Examples of applying this principle",
          "items": {
            "$ref": "#/definitions/PrincipleExample"
          }
        },
        "priority": {
          "type": "integer",
          "description": "Priority for conflict resolution (higher wins)",
          "default": 0
        },
        "zones": {
          "type": "array",
          "description": "Zones where this principle applies (empty = all zones)",
          "items": {
            "type": "string"
          },
          "default": []
        }
      },
      "required": ["id", "name", "statement", "rationale"]
    },
    "PrincipleExample": {
      "type": "object",
      "description": "Example of principle application",
      "properties": {
        "scenario": {
          "type": "string",
          "description": "The scenario"
        },
        "good": {
          "type": "string",
          "description": "Good application of the principle"
        },
        "bad": {
          "type": "string",
          "description": "Bad application to avoid"
        }
      },
      "required": ["scenario", "good"]
    },
    "ConflictResolution": {
      "type": "object",
      "description": "Rules for resolving conflicts between concerns",
      "properties": {
        "rules": {
          "type": "array",
          "description": "Conflict resolution rules",
          "items": {
            "$ref": "#/definitions/ConflictRule"
          }
        },
        "default_strategy": {
          "type": "string",
          "description": "Default strategy when no rule matches",
          "enum": ["priority", "first", "merge", "ask"],
          "default": "priority"
        }
      },
      "required": ["rules"]
    },
    "ConflictRule": {
      "type": "object",
      "description": "A specific conflict resolution rule",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique rule identifier"
        },
        "conflict": {
          "type": "array",
          "description": "The two concerns in conflict",
          "items": {
            "type": "string"
          },
          "minItems": 2,
          "maxItems": 2
        },
        "winner": {
          "type": "string",
          "description": "Which concern wins"
        },
        "rationale": {
          "type": "string",
          "description": "Why this resolution was chosen"
        },
        "context": {
          "type": "string",
          "description": "Context where this applies",
          "enum": ["always", "critical_zone", "marketing_zone", "admin_zone"],
          "default": "always"
        }
      },
      "required": ["id", "conflict", "winner", "rationale"]
    }
  }
}
