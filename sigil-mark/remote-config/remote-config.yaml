# Sigil v3.0 — Remote Configuration
#
# Clear separation between marketing-controlled and engineering-controlled values.
# Physics values are ALWAYS local — never remote.
#
# Philosophy: "Marketing owns copy. Engineering owns physics. Both own trust."

version: "3.0.0"

# =============================================================================
# INTEGRATION SETTINGS
# =============================================================================
# Sigil supports multiple remote config providers.
# Default is local_yaml (this file).

integration:
  provider: local_yaml  # Options: local_yaml, launchdarkly, statsig, firebase, custom
  # api_key_env: SIGIL_REMOTE_CONFIG_KEY  # Uncomment for remote providers
  refresh_interval_ms: 0  # 0 = manual only, 300000 = 5 minutes
  timeout_ms: 5000

# =============================================================================
# MARKETING CONTROLLED VALUES
# =============================================================================
# These values can be modified by marketing without engineering review.
# Safe to change: copy, feature visibility, promotions, survey triggers.

marketing_controlled:
  # ---------------------------------------------------------------------------
  # UI Copy
  # ---------------------------------------------------------------------------
  copy:
    hero_headline:
      value: "Your Crypto, Your Way"
      variants:
        a: "Your Crypto, Your Way"
        b: "Take Control of Your Assets"
      zones: ["marketing", "landing"]

    deposit_cta:
      value: "Deposit Now"
      zones: ["critical"]

    withdraw_cta:
      value: "Withdraw"
      zones: ["critical"]

    empty_state_message:
      value: "Ready to get started? Make your first deposit."
      zones: ["dashboard"]

  # ---------------------------------------------------------------------------
  # Feature Flags
  # ---------------------------------------------------------------------------
  feature_flags:
    show_new_dashboard:
      enabled: false
      rollout_percentage: 0
      targeting:
        personas: ["power_user"]
        zones: ["dashboard"]

    enable_dark_mode_toggle:
      enabled: true
      rollout_percentage: 100

    show_referral_banner:
      enabled: false
      targeting:
        zones: ["marketing", "landing"]

  # ---------------------------------------------------------------------------
  # Promotions
  # ---------------------------------------------------------------------------
  promotions:
    launch_promo:
      enabled: false
      title: "Launch Special"
      message: "Get 0% fees on your first deposit"
      cta_text: "Learn More"
      cta_url: "/promo/launch"
      start_date: "2026-01-01T00:00:00Z"
      end_date: "2026-02-01T00:00:00Z"
      zones: ["marketing", "dashboard"]

  # ---------------------------------------------------------------------------
  # Survey Triggers (Vibe Checks)
  # ---------------------------------------------------------------------------
  # Enable/disable specific survey triggers
  survey_triggers:
    strategy_change: true
    first_deposit: true
    first_withdraw: true
    transaction_failed: true
    card_expanded: false  # Disabled for now
    onboarding_completed: true

# =============================================================================
# ENGINEERING CONTROLLED VALUES
# =============================================================================
# These values require engineering review to modify.
# Security-critical and performance-critical settings.

engineering_controlled:
  # ---------------------------------------------------------------------------
  # Physics
  # ---------------------------------------------------------------------------
  # IMPORTANT: Physics are ALWAYS local. Never remote.
  # This is a constitutional constraint — physics affect trust.
  physics: local_only

  # ---------------------------------------------------------------------------
  # Rate Limits
  # ---------------------------------------------------------------------------
  rate_limits:
    api_general:
      requests_per_minute: 60
      burst_limit: 10
      cooldown_ms: 1000

    api_transactions:
      requests_per_minute: 10
      burst_limit: 2
      cooldown_ms: 5000

    survey_display:
      requests_per_minute: 2
      burst_limit: 1
      cooldown_ms: 30000

  # ---------------------------------------------------------------------------
  # Timeouts
  # ---------------------------------------------------------------------------
  timeouts:
    transaction_confirmation_ms: 30000
    api_call_ms: 10000
    websocket_reconnect_ms: 5000
    session_idle_ms: 900000  # 15 minutes

  # ---------------------------------------------------------------------------
  # Security Settings
  # ---------------------------------------------------------------------------
  security_settings:
    require_2fa_for_withdrawals: true
    max_failed_login_attempts: 5
    lockout_duration_ms: 900000  # 15 minutes
    session_token_expiry_ms: 86400000  # 24 hours

# =============================================================================
# FALLBACK BEHAVIOR
# =============================================================================
# What to do when remote config is unavailable.

fallback_behavior:
  strategy: local_yaml  # Options: local_yaml, cached, default, fail_open, fail_closed
  cache_ttl_ms: 86400000  # 24 hours
  alert_on_fallback: true
